<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Bill Section</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 400px;
    margin: 20px auto;
    padding: 10px;
    background: #f7f7f7;
    border-radius: 8px;
  }
  h2 {
    text-align: center;
    color: #333;
  }
  label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
  }
  input[type="text"], input[type="number"], input[type="date"] {
    width: 100%;
    padding: 8px;
    margin-top: 6px;
    box-sizing: border-box;
  }
  table {
    width: 100%;
    margin-top: 15px;
    border-collapse: collapse;
  }
  th, td {
    padding: 8px;
    border-bottom: 1px solid #ccc;
    text-align: left;
  }
  #total {
    text-align: right;
    margin-top: 10px;
    font-weight: bold;
    font-size: 1.1em;
  }
  button {
    margin-top: 15px;
    padding: 8px 12px;
    background: #007bff;
    border: none;
    color: white;
    border-radius: 4px;
    cursor: pointer;
    width: 48%;
    margin-right: 4%;
  }
  button:hover {
    background: #0056b3;
  }
  #whatsappBtn {
    background: #25D366;
    margin-right: 0;
  }
  @media print {
    body * {
      visibility: hidden;
    }
    #printArea, #printArea * {
      visibility: visible;
    }
    #printArea {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
    }
    button {
      display: none;
    }
  }
</style>
</head>
<body>

<h2>Bill Section</h2>

<label for="customerName">Customer Name</label>
<input type="text" id="customerName" placeholder="Enter customer name" />

<label for="billDate">Date</label>
<input type="date" id="billDate" value="" />

<label for="productName">Product Name</label>
<input type="text" id="productName" placeholder="Enter product name" />

<label for="quantity">Quantity</label>
<input type="number" id="quantity" min="1" value="1" />

<label for="price">Price (Rs)</label>
<input type="number" id="price" min="0" step="0.01" value="0" />

<button onclick="addItem()">Add Item</button>

<div id="printArea" style="margin-top:20px; display:none;">
  <p><strong>Customer Name:</strong> <span id="printCustomerName"></span></p>
  <p><strong>Date:</strong> <span id="printDate"></span></p>
  <table id="billTablePrint" style="width:100%; border-collapse: collapse;">
    <thead>
      <tr>
        <th style="border-bottom: 1px solid #000;">Product</th>
        <th style="border-bottom: 1px solid #000;">Qty</th>
        <th style="border-bottom: 1px solid #000;">Price (Rs)</th>
        <th style="border-bottom: 1px solid #000;">Amount (Rs)</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
  <p id="totalPrint" style="text-align:right; font-weight:bold; margin-top:10px;"></p>
</div>

<div style="margin-top:10px;">
  <button onclick="printBill()">Print Bill</button>
  <button id="whatsappBtn" onclick="shareOnWhatsApp()">Share on WhatsApp</button>
</div>

<script>
  document.getElementById('billDate').value = new Date().toISOString().substring(0, 10);

  let totalAmount = 0;
  let billItems = [];

  function addItem() {
    const customerName = document.getElementById('customerName').value.trim();
    const billDate = document.getElementById('billDate').value;
    const productName = document.getElementById('productName').value.trim();
    const quantity = parseInt(document.getElementById('quantity').value);
    const price = parseFloat(document.getElementById('price').value);

    if (!customerName) {
      alert('Please enter customer name');
      return;
    }
    if (!billDate) {
      alert('Please select a date');
      return;
    }
    if (!productName) {
      alert('Please enter product name');
      return;
    }
    if (quantity <= 0 || price < 0) {
      alert('Please enter valid quantity and price');
      return;
    }

    const amount = quantity * price;
    totalAmount += amount;
    billItems.push({productName, quantity, price, amount});

    // Show in print area
    document.getElementById('printArea').style.display = 'block';
    document.getElementById('printCustomerName').textContent = customerName;
    document.getElementById('printDate').textContent = billDate;

    const tbody = document.querySelector('#billTablePrint tbody');
    const newRow = document.createElement('tr');
    newRow.innerHTML = `
      <td>${productName}</td>
      <td>${quantity}</td>
      <td>Rs ${price.toFixed(2)}</td>
      <td>Rs ${amount.toFixed(2)}</td>
    `;
    tbody.appendChild(newRow);

    document.getElementById('totalPrint').textContent = 'Total: Rs ' + totalAmount.toFixed(2);

    // Clear product input fields
    document.getElementById('productName').value = '';
    document.getElementById('quantity').value = 1;
    document.getElementById('price').value = 0;
  }

  function printBill() {
    if (billItems.length === 0) {
      alert('Add some products before printing the bill.');
      return;
    }
    window.print();
  }

  function shareOnWhatsApp() {
    if (billItems.length === 0) {
      alert('Add some products before sharing the bill.');
      return;
    }
    const customerName = document.getElementById('customerName').value.trim();
    const billDate = document.getElementById('billDate').value;

    let message = `Bill Details
Customer: ${customerName}
Date: ${billDate}

Products:
`;
    billItems.forEach(item => {
      message += `${item.productName} - Qty: ${item.quantity}, Price: Rs ${item.price.toFixed(2)}, Amount: Rs ${item.amount.toFixed(2)}
`;
    });
    message += `
Total: Rs ${totalAmount.toFixed(2)}`;

    const encodedMessage = encodeURIComponent(message);
    const whatsappURL = `https://wa.me/?text=${encodedMessage}`;
    window.open(whatsappURL, '_blank');
  }
</script>

</body>
</html>
